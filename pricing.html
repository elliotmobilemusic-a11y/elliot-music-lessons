<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Elliot Wardill – Lesson Fees & Policy</title>
  <link rel="icon" href="/favicon.png" type="image/png">

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-dark-bg': '#1a1a2e',
            'brand-accent-light': '#00d084',
            'brand-accent-dark': '#00a36e',
            'brand-text-light': '#e0e0e0',
            'brand-text-mid': '#a0e0e0',          /* match home */
            'brand-highlight': '#ffb703',
            'card-bg': '#252538',
          },
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            heading: ['Montserrat', 'sans-serif'],
          },
        }
      }
    }
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@700;800;900&display=swap');

    body{
      font-family: 'Inter', sans-serif;
      background-color:#1a1a2e;
      color:#e0e0e0;
      /* premium soft gradient backdrop */
      background-image:
        radial-gradient(1200px 600px at 105% -10%, rgba(0,208,132,0.12), transparent 60%),
        radial-gradient(900px 500px at -10% 110%, rgba(255,183,3,0.10), transparent 60%),
        radial-gradient(circle at 100% 100%, #252538 0%, #1a1a2e 70%);
    }

    /* Glow + elevation */
    .card-glow{
      box-shadow:
        0 12px 32px rgba(0,0,0,0.45),
        0 10px 30px rgba(0,208,132,0.12),
        inset 0 0 0 1px rgba(255,255,255,0.02);
    }
    .ring-glow{
      box-shadow:
        0 0 0 1px rgba(0,208,132,0.25),
        0 0 24px rgba(0,208,132,0.25);
    }

    /* Sections reveal */
    .reveal{
      opacity:0;
      transform: translateY(22px);
      transition: opacity .7s ease, transform .7s ease;
    }
    .reveal.visible{
      opacity:1;
      transform:none;
    }
    .reveal.d1{ transition-delay: .08s }
    .reveal.d2{ transition-delay: .15s }
    .reveal.d3{ transition-delay: .22s }

    /* Tables */
    .policy-table th{
      background: linear-gradient(90deg, #00a36e, #00d084);
      color:#1a1a2e;
      font-weight:800;
      letter-spacing:.02em;
    }
    .policy-table td{
      background:#2a2a43;
      border-bottom:1px solid rgba(255,255,255,0.06);
    }
    .policy-table tr:hover td{
      background:#313152;
    }

    /* Buttons */
    .btn-primary{
      background: linear-gradient(180deg, #00d084, #00a36e);
      color:#0f172a;
      font-weight:700;
      box-shadow: 0 12px 22px rgba(0,208,132,.25);
      transition: transform .15s ease, box-shadow .15s ease, filter .15s ease;
    }
    .btn-primary:hover{ transform: translateY(-1px) scale(1.01); filter: brightness(1.05); }
    .btn-outline{
      border:1px solid rgba(255,183,3,.55);
      color:#ffb703;
    }
    .btn-outline:hover{
      background: rgba(255,183,3,.12);
    }

    /* Spinner */
    .spinner{
      border: 4px solid rgba(255,255,255,0.25);
      border-top: 4px solid #ffb703;
      border-radius: 50%;
      width: 22px; height: 22px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg)} }

    /* Chat-typing dots (reused styling if needed later) */
    @keyframes dot-pulse{
      0%,100%{ opacity:.25; transform:scale(1) }
      50%{ opacity:1; transform:scale(1.3) }
    }
    .dot-1{ animation: dot-pulse 1.4s infinite 0s }
    .dot-2{ animation: dot-pulse 1.4s infinite .2s }
    .dot-3{ animation: dot-pulse 1.4s infinite .4s }

    /* Subtle hover-lift */
    .hover-lift{ transition: transform .18s ease }
    .hover-lift:hover{ transform: translateY(-3px) }
  </style>

  <!-- Lucide Icons -->
  <script type="module">
    import { createIcons, Calculator, MapPin, BookOpen, Shield, Clock, XCircle, CheckCircle2 } from 'https://cdn.jsdelivr.net/npm/lucide@latest/dist/esm/lucide.js';
    createIcons({ icons: { Calculator, MapPin, BookOpen, Shield, Clock, XCircle, CheckCircle2 } });
  </script>
</head>
<body class="min-h-screen flex flex-col">

  <!-- NAV -->
  <nav class="bg-brand-dark-bg/90 backdrop-blur border-b border-brand-accent-dark/40 text-white sticky top-0 z-50">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <a href="index.html" class="flex items-center space-x-2">
          <span class="inline-flex items-center justify-center w-9 h-9 rounded-full bg-brand-accent-light/10 border border-brand-accent-light/50">
            <i data-lucide="book-open" class="w-5 h-5 text-brand-accent-light"></i>
          </span>
          <span class="text-sm sm:text-base font-heading font-extrabold tracking-[0.18em] text-brand-highlight">
            ELLIOT'S MOBILE MUSIC
          </span>
        </a>

        <!-- Desktop -->
        <div class="hidden sm:flex sm:space-x-4 text-xs md:text-sm">
          <a href="index.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium">HOME</a>
          <a href="pricing.html" class="border-b-2 border-brand-accent-light text-brand-accent-light px-3 py-2 font-medium">PRICING & FEES</a>
          <a href="availability.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium">AVAILABILITY</a>
          <a href="contact.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium">CONTACT</a>
        </div>

        <!-- Mobile -->
        <div class="sm:hidden">
          <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-300 hover:text-white hover:bg-brand-accent-dark focus:outline-none focus:ring-2 focus:ring-white">
            <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
                 viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div class="sm:hidden hidden" id="mobile-menu">
      <div class="pt-2 pb-3 space-y-1 px-3 text-sm">
        <a href="index.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">HOME</a>
        <a href="pricing.html" class="block rounded-md bg-brand-accent-dark text-white px-3 py-2 font-medium">PRICING & FEES</a>
        <a href="availability.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">AVAILABILITY</a>
        <a href="contact.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">CONTACT</a>
      </div>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="flex-grow">
    <!-- HERO -->
    <header class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 sm:pt-24 pb-10">
      <div class="text-center reveal">
        <p class="text-xs font-semibold tracking-[0.28em] text-brand-highlight mb-3 uppercase">
          CLEAR • FAIR • TRANSPARENT
        </p>
        <h1 class="font-heading text-4xl sm:text-5xl lg:text-6xl font-extrabold leading-tight mb-4">
          Lesson Fees & <span class="text-brand-accent-light">Policy</span>
        </h1>
        <p class="text-brand-text-mid text-base sm:text-lg max-w-3xl mx-auto">
          Simple pricing for piano & singing lessons at your home in Pudsey and West Leeds.  
          Fully DBS checked, insured, and parent-friendly.
        </p>
      </div>
    </header>

    <!-- CALCULATOR -->
    <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
      <div class="rounded-2xl bg-card-bg/80 border border-brand-accent-dark/50 p-6 sm:p-8 card-glow reveal d1">
        <div class="flex items-center justify-between gap-4 border-b border-white/10 pb-4 mb-6">
          <div class="flex items-center gap-3">
            <span class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-brand-accent-light/10 ring-1 ring-brand-accent-light/40">
              <i data-lucide="calculator" class="w-5 h-5 text-brand-accent-light"></i>
            </span>
            <div>
              <h2 class="font-heading text-2xl sm:text-3xl font-bold text-brand-accent-light">Calculate Your Total Lesson Cost</h2>
              <p class="text-brand-text-mid text-sm">
                Enter your <strong>outward postcode</strong> (e.g. <strong>LS28</strong>) and choose a duration.  
                We simulate <strong>road distance</strong> from <strong>Pudsey</strong> to give your total.
              </p>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
          <select id="lesson-duration" class="p-3 rounded-lg bg-brand-dark-bg border border-brand-accent-dark text-white focus:border-brand-highlight focus:ring-brand-highlight w-full">
            <option value="30">30 Minutes (£15.00)</option>
            <option value="60" selected>60 Minutes (£30.00)</option>
            <option value="90">90 Minutes (£50.00)</option>
          </select>

          <div class="md:col-span-2">
            <input id="postcode-input" type="text" placeholder="Enter Outward Postcode (e.g. LS28)"
                   class="w-full p-3 rounded-lg bg-brand-dark-bg border border-brand-accent-dark text-white focus:border-brand-highlight focus:ring-brand-highlight uppercase"/>
            <p class="mt-2 text-xs text-brand-text-mid">
              Tip: You can also press <span class="px-1.5 py-0.5 rounded bg-white/10">Enter</span> to calculate.
            </p>
          </div>
        </div>

        <button id="check-fee-button"
                class="w-full px-6 py-3 rounded-lg btn-primary flex items-center justify-center gap-3">
          <span id="button-text">Calculate Final Price</span>
          <span id="loading-spinner" class="spinner hidden"></span>
        </button>

        <div id="fee-result" class="mt-6 p-5 rounded-xl text-center font-bold hidden border border-brand-highlight/40 bg-black/20"></div>
        <p class="text-xs text-brand-text-mid mt-3 text-center">
          *This is an accurate estimate using a road-distance simulation. We’ll confirm at booking if needed.
        </p>
      </div>
    </section>

    <!-- RATES -->
    <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
      <div class="rounded-2xl bg-card-bg/80 border border-brand-accent-dark/50 p-6 sm:p-8 card-glow reveal d2">
        <div class="flex items-center gap-3 mb-5">
          <span class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-brand-accent-light/10 ring-1 ring-brand-accent-light/40">
            <i data-lucide="book-open" class="w-5 h-5 text-brand-accent-light"></i>
          </span>
          <h2 class="font-heading text-2xl sm:text-3xl font-bold text-brand-accent-light">Standard Lesson Rates</h2>
        </div>

        <div class="overflow-x-auto rounded-lg ring-1 ring-white/10">
          <table class="w-full text-left policy-table text-brand-text-light">
            <thead>
              <tr>
                <th class="px-6 py-3">Lesson Duration</th>
                <th class="px-6 py-3">Fee (Base)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="px-6 py-4 font-semibold">Introductory Offer (First Lesson)</td>
                <td class="px-6 py-4 text-brand-highlight font-extrabold">£10.00</td>
              </tr>
              <tr>
                <td class="px-6 py-4 font-semibold">30 Minutes</td>
                <td class="px-6 py-4">£15.00</td>
              </tr>
              <tr>
                <td class="px-6 py-4 font-semibold">60 Minutes</td>
                <td class="px-6 py-4">£30.00</td>
              </tr>
              <tr>
                <td class="px-6 py-4 font-semibold">90 Minutes</td>
                <td class="px-6 py-4">£50.00</td>
              </tr>
            </tbody>
          </table>
        </div>

        <p class="mt-4 text-brand-text-mid text-sm">
          Payment can be made in cash at the lesson or by bank transfer in advance.
        </p>
      </div>
    </section>

    <!-- TRAVEL & CANCELLATION -->
    <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
      <div class="grid md:grid-cols-2 gap-6">
        <!-- Travel -->
        <div class="rounded-2xl bg-card-bg/80 border border-brand-accent-dark/50 p-6 sm:p-8 card-glow reveal d1">
          <div class="flex items-center gap-3 mb-5">
            <span class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-brand-accent-light/10 ring-1 ring-brand-accent-light/40">
              <i data-lucide="map-pin" class="w-5 h-5 text-brand-accent-light"></i>
            </span>
            <h3 class="font-heading text-2xl font-bold text-brand-accent-light">Travel Fee Bands</h3>
          </div>

          <p class="text-brand-text-mid mb-4">
            Lessons are based in <strong>Pudsey</strong>. Travel fees apply based on the simulated road distance.
          </p>

          <div class="overflow-x-auto rounded-lg ring-1 ring-white/10">
            <table class="w-full text-left policy-table text-brand-text-light text-sm">
              <thead>
                <tr>
                  <th class="px-4 py-2">Estimated Road Distance</th>
                  <th class="px-4 py-2">Additional Fee</th>
                </tr>
              </thead>
              <tbody>
                <tr><td class="px-4 py-2">Under 5 miles</td><td class="px-4 py-2">£0.00</td></tr>
                <tr><td class="px-4 py-2">5 – 10 miles</td><td class="px-4 py-2">£5.00</td></tr>
                <tr><td class="px-4 py-2">10 – 15 miles</td><td class="px-4 py-2">£10.00</td></tr>
                <tr><td class="px-4 py-2">15+ miles</td><td class="px-4 py-2">£20.00 (flat)</td></tr>
              </tbody>
            </table>
          </div>

          <p class="mt-3 text-xs text-brand-text-mid">
            The calculator above uses these bands to determine your total.
          </p>
        </div>

        <!-- Cancellation -->
        <div class="rounded-2xl bg-card-bg/80 border border-brand-accent-dark/50 p-6 sm:p-8 card-glow reveal d2">
          <div class="flex items-center gap-3 mb-5">
            <span class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-brand-accent-light/10 ring-1 ring-brand-accent-light/40">
              <i data-lucide="x-circle" class="w-5 h-5 text-brand-highlight"></i>
            </span>
            <h3 class="font-heading text-2xl font-bold text-brand-accent-light">Cancellation Policy</h3>
          </div>

          <ul class="list-disc ml-5 space-y-3 text-brand-text-mid">
            <li><strong>24 hours’ notice</strong> required to cancel or reschedule a lesson.</li>
            <li><strong>Under 24 hours</strong> may incur a <strong>50%</strong> late cancellation charge.</li>
            <li>If Elliot cancels, your lesson will be <strong>rescheduled at no extra cost</strong>.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- FULL POLICY (COLLAPSIBLE) -->
    <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-20">
      <div class="rounded-2xl bg-card-bg/80 border border-brand-accent-dark/50 p-6 sm:p-8 card-glow reveal d3">
        <button id="toggle-policy"
                class="w-full text-left p-4 rounded-xl bg-brand-dark-bg/60 hover:bg-brand-dark-bg/50 ring-1 ring-white/10 text-white font-bold text-lg transition flex justify-between items-center">
          View Full Music Lesson Policy Document
          <span id="toggle-icon">▼</span>
        </button>

        <div id="full-policy-text" class="hidden mt-4 p-5 rounded-xl ring-1 ring-white/10 bg-black/20 max-h-96 overflow-y-auto">
          <h3 class="font-heading text-2xl font-bold text-brand-highlight mb-3">Elliot Wardill Music Lesson Policy</h3>

          <p>Hello, thank you for booking music lessons! I am Elliot Wardill, a musician and educator based in Pudsey. I have been playing piano and singing for several years and currently work within the education sector. This policy outlines key terms to ensure a clear and smooth lesson experience for everyone.</p>
          <p>I bring all the necessary equipment (including a keyboard) to your home, so there is no need to travel or provide your own instrument. Lessons are designed to be fun, safe, inspiring, and tailored to each student's goals.</p>

          <h4 class="font-heading text-xl font-bold text-brand-text-light mt-5 mb-2">1. Safety and Safeguarding</h4>
          <p>I hold a valid <strong>DBS check</strong> for working with children, ensuring a safe learning environment. Parents/guardians are welcome to sit in on lessons.</p>
          <p>If your child is enrolled at Stanningley Primary School, any information or incidents disclosed to me during lesson times will be reported directly to the school authorities in line with safeguarding procedures.</p>

          <h4 class="font-heading text-xl font-bold text-brand-text-light mt-5 mb-2">2. Lesson Fees and Payment</h4>
          <p><strong>First Lesson:</strong> £10 (introductory offer).</p>
          <p><strong>Standard Lessons:</strong> 30 minutes: £15 / 60 minutes: £30 / 90 minutes: £50.</p>
          <p>The total price, including the travel fee, is calculated by the tool above.</p>

          <h4 class="font-heading text-xl font-bold text-brand-text-light mt-5 mb-2">3. Cancellations and Rescheduling</h4>
          <p><strong>Notice Required:</strong> Please give at least 24 hours' notice if you need to cancel or reschedule a lesson.</p>
          <p><strong>Late Cancellation Fee:</strong> Cancellations with less than 24 hours' notice may be charged 50% of the lesson fee.</p>
          <p><strong>Instructor Cancellation:</strong> If I ever need to cancel, I will reschedule the lesson at no extra cost to you.</p>

          <h4 class="font-heading text-xl font-bold text-brand-text-light mt-5 mb-2">4. Lesson Structure and Approach</h4>
          <p>Lessons are tailored to each student's age, goals, and interests. For beginners, we will start with fun, simple songs. We will gradually build skills in musicality, rhythm, and performance confidence.</p>

          <h4 class="font-heading text-xl font-bold text-brand-text-light mt-5 mb-2">5. Travel and Location (Road Distance-based)</h4>
          <p>Lessons are available in the wider Leeds and Bradford areas. Travel fees apply outside the immediate Pudsey area. The fee is calculated based on the <strong>estimated road distance</strong> from Pudsey to your outward postcode (e.g., LS28) and is added to the standard lesson cost:</p>
          <ul class="list-disc ml-5 text-brand-text-mid">
            <li>Under 5 miles: <strong>£0.00</strong></li>
            <li>5 – 10 miles: <strong>£5.00</strong></li>
            <li>10 – 15 miles: <strong>£10.00</strong></li>
            <li>15+ miles: <strong>£20.00</strong> (max flat rate)</li>
          </ul>

          <h4 class="font-heading text-xl font-bold text-brand-text-light mt-5 mb-2">6. Availability</h4>
          <p>Standard evening availability: Tuesday, Wednesday & Thursday (6–9pm). Weekends on request. Monday & Friday unavailable.</p>
          <p>Note: Availability may change during term time.</p>

          <h4 class="font-heading text-xl font-bold text-brand-text-light mt-5 mb-2">Contact</h4>
          <p>Phone: 07368 975144<br>Email: elliotmobilemusic@gmail.com</p>
        </div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="bg-gray-900 text-brand-text-mid py-7 mt-2">
    <div class="max-w-6xl mx-auto px-4 text-center text-xs sm:text-sm">
      <p>&copy; <span id="year"></span> Elliot Wardill Mobile Music Lessons. All rights reserved.</p>
      <p class="mt-1 text-gray-500">DBS Checked & Insured. Policy details are provided above.</p>
    </div>
  </footer>

  <!-- JS -->
  <script>
    // --- Mobile menu
    document.getElementById('mobile-menu-button').addEventListener('click', () => {
      document.getElementById('mobile-menu').classList.toggle('hidden');
    });

    // --- Auto-year
    document.getElementById('year').textContent = new Date().getFullYear();

    // --- Reveal on view
    const rev = document.querySelectorAll('.reveal');
    if(rev.length){
      const obs = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            e.target.classList.add('visible');
            obs.unobserve(e.target);
          }
        })
      },{threshold:.12});
      rev.forEach(el=>obs.observe(el));
    }

    // --- Pricing calculator (same logic, polished UI)
    const PUDSEY_CENTER = { lat: 53.8116, lng: -1.6706 };
    const EARTH_RADIUS_MILES = 3958.8;
    const ROAD_DISTANCE_FACTOR = 1.3;
    const LESSON_RATES = { 30: 15.00, 60: 30.00, 90: 50.00 };

    const postcodeCoords = {
      /* Leeds (LS) */
      "LS28": { lat: 53.8116, lng: -1.6706 },
      "LS13": { lat: 53.8120, lng: -1.6150 },
      "LS19": { lat: 53.8640, lng: -1.7140 },
      "LS20": { lat: 53.8810, lng: -1.7220 },
      "LS21": { lat: 53.9030, lng: -1.6880 },
      "LS6":  { lat: 53.8290, lng: -1.5800 },
      "LS18": { lat: 53.8340, lng: -1.6240 },
      "LS12": { lat: 53.7930, lng: -1.5970 },
      "LS5":  { lat: 53.8280, lng: -1.6030 },
      "LS16": { lat: 53.8580, lng: -1.6060 },
      "LS4":  { lat: 53.8050, lng: -1.5790 },
      "LS15": { lat: 53.8050, lng: -1.4550 },
      "LS14": { lat: 53.8210, lng: -1.4560 },
      "LS1":  { lat: 53.7990, lng: -1.5470 },
      "LS2":  { lat: 53.8040, lng: -1.5430 },
      "LS25": { lat: 53.7840, lng: -1.3850 },

      /* Bradford (BD) */
      "BD10": { lat: 53.8490, lng: -1.7770 },
      "BD17": { lat: 53.8650, lng: -1.7760 },
      "BD18": { lat: 53.8480, lng: -1.7480 },
      "BD1":  { lat: 53.7950, lng: -1.7580 },
      "BD2":  { lat: 53.8220, lng: -1.7760 },
      "BD3":  { lat: 53.8080, lng: -1.7160 },
      "BD5":  { lat: 53.7740, lng: -1.7650 },

      /* Wakefield (WF) & Calderdale (HD/HX) */
      "WF3": { lat: 53.7540, lng: -1.5790 },
      "WF17":{ lat: 53.7150, lng: -1.6090 },
      "HD6": { lat: 53.7020, lng: -1.7850 },
      "HX1": { lat: 53.7250, lng: -1.8600 },
    };

    function haversineMiles(lat1,lon1,lat2,lon2){
      const dLat = (lat2-lat1) * (Math.PI/180);
      const dLon = (lon2-lon1) * (Math.PI/180);
      const a = Math.sin(dLat/2)**2 +
                Math.cos(lat1*(Math.PI/180)) * Math.cos(lat2*(Math.PI/180)) *
                Math.sin(dLon/2)**2;
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return EARTH_RADIUS_MILES * c;
    }

    function travelBand(roadMiles){
      let fee = 0, label = "Under 5 miles", color = "text-brand-accent-light";
      if(roadMiles >= 5 && roadMiles < 10){ fee=5; label="5 – 10 miles"; color="text-brand-highlight"; }
      else if(roadMiles >= 10 && roadMiles < 15){ fee=10; label="10 – 15 miles"; color="text-brand-highlight"; }
      else if(roadMiles >= 15){ fee=20; label="15+ miles (max)"; color="text-red-400"; }
      if(roadMiles > 50){ fee=20; label="Remote area (max)"; color="text-red-400"; }
      return { fee, label, color };
    }

    function outward(postcode){
      if(!postcode) return null;
      const cleaned = postcode.replace(/\s+/g,'').toUpperCase();
      const m1 = cleaned.match(/^([A-Z]{1,2}[0-9][A-Z0-9]?).*$/);
      if(m1 && m1[1]) return m1[1];
      const m2 = cleaned.match(/^[A-Z]{1,2}[0-9][A-Z0-9]?$/);
      return m2 ? m2[0] : null;
    }

    const btn = document.getElementById('check-fee-button');
    const spinner = document.getElementById('loading-spinner');
    const btnText = document.getElementById('button-text');
    const resBox = document.getElementById('fee-result');

    async function handleCalc(){
      btn.disabled = true;
      spinner.classList.remove('hidden');
      btnText.textContent = 'Calculating...';
      resBox.classList.add('hidden');

      const pc = document.getElementById('postcode-input').value;
      const code = outward(pc);
      const dur = document.getElementById('lesson-duration').value;
      const base = LESSON_RATES[dur];

      setTimeout(()=>{ // polish: slight delay for UX
        resBox.classList.remove('hidden');
        resBox.classList.remove('bg-red-900/50','bg-green-900/40');

        if(!code){
          resBox.innerHTML = '❌ Please enter a valid UK outward postcode (e.g. LS28).';
          resBox.classList.add('bg-red-900/50');
          btn.disabled = false; spinner.classList.add('hidden'); btnText.textContent='Calculate Final Price';
          return;
        }

        const dest = postcodeCoords[code];
        if(dest){
          const straight = haversineMiles(PUDSEY_CENTER.lat, PUDSEY_CENTER.lng, dest.lat, dest.lng);
          const road = straight * ROAD_DISTANCE_FACTOR;
          const band = travelBand(road);
          const total = base + band.fee;

          resBox.innerHTML = `
            <div class="md:flex justify-between items-center gap-6 text-left">
              <div class="space-y-1">
                <p class="text-sm text-brand-text-mid">Postcode Area: <strong>${code}</strong></p>
                <p class="text-sm text-brand-text-mid">Estimated Road Distance: <strong>${road.toFixed(1)} miles</strong> (${band.label})</p>
              </div>
              <div class="text-right space-y-1">
                <p class="text-brand-text-light">Lesson Fee (${dur} min): £${base.toFixed(2)}</p>
                <p class="text-brand-text-light">Travel Fee: <span class="${band.color} text-xl font-extrabold">£${band.fee.toFixed(2)}</span></p>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-brand-accent-light/40">
              <p class="text-brand-highlight text-3xl font-extrabold">Total Estimated Cost: £${total.toFixed(2)}</p>
            </div>
          `;
          resBox.classList.add('bg-green-900/40');
        } else {
          const band = travelBand(100); // force max
          const total = base + band.fee;
          resBox.innerHTML = `
            <p class="text-red-400 text-lg font-extrabold mb-1">⚠️ Postcode <strong>${code}</strong> appears outside the main coverage area.</p>
            <p class="text-brand-text-light">Max Travel Fee Applied: £${band.fee.toFixed(2)}</p>
            <p class="text-brand-highlight text-3xl font-extrabold mt-2">Total Estimated Cost: £${total.toFixed(2)}</p>
            <p class="text-xs text-brand-text-mid mt-2">Please contact Elliot to confirm this long-distance booking.</p>
          `;
          resBox.classList.add('bg-red-900/50');
        }

        btn.disabled = false;
        spinner.classList.add('hidden');
        btnText.textContent = 'Calculate Final Price';
      }, 480);
    }

    btn.addEventListener('click', handleCalc);
    document.getElementById('postcode-input').addEventListener('keypress', (e)=>{
      if(e.key === 'Enter'){ handleCalc(); }
    });

    // Policy toggle
    document.getElementById('toggle-policy').addEventListener('click', ()=>{
      const box = document.getElementById('full-policy-text');
      const icon = document.getElementById('toggle-icon');
      const isHidden = box.classList.contains('hidden');
      box.classList.toggle('hidden');
      icon.textContent = isHidden ? '▲' : '▼';
    });
  </script>
</body>
</html>
