<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard â€“ Elliot's Mobile Music</title>

    <!-- Favicon -->
    <link rel="icon" href="/favicon.png" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-dark-bg': '#1a1a2e',
                        'brand-accent-light': '#00d084',
                        'brand-accent-dark': '#00a36e',
                        'brand-text-light': '#e0e0e0',
                        'brand-text-mid': '#a0a0a0',
                        'brand-highlight': '#ffb703',
                        'card-bg': '#252538',
                        'error-red': '#f87171',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Montserrat', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <!-- Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@700;800;900&display=swap');
        body {
            background: #1a1a2e;
            color: #e0e0e0;
            background-image: radial-gradient(circle at 100% 100%, #252538 0%, #1a1a2e 70%);
        }
        .card-glow {
            box-shadow: 0 0 25px rgba(0, 208, 132, 0.12);
        }
        .hover-lift {
            transition: transform 0.2s ease;
        }
        .hover-lift:hover {
            transform: translateY(-3px);
        }
    </style>

    <!-- Lucide Icons -->
    <script type="module">
        import {
            createIcons, User, Users, FileText, BookOpen, Calendar, Settings,
            LogOut, ShieldCheck, FileEdit
        } from "https://cdn.jsdelivr.net/npm/lucide@latest/dist/esm/lucide.js";

        createIcons({
            icons: { User, Users, FileText, BookOpen, Calendar, Settings, LogOut, ShieldCheck, FileEdit }
        });
    </script>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>

</head>
<body class="min-h-screen flex flex-col">

    <!-- HEADER BAR -->
    <header class="w-full border-b border-brand-accent-dark/40 px-6 py-4 bg-brand-dark-bg/80 backdrop-blur flex justify-between items-center">
        <h1 class="font-heading text-xl sm:text-2xl font-extrabold tracking-[0.18em] text-brand-highlight">
            ADMIN DASHBOARD
        </h1>

        <button id="logout-btn" class="flex items-center gap-2 bg-error-red/20 px-4 py-2 rounded-lg text-error-red hover:bg-error-red/30 transition">
            <i data-lucide="log-out" class="w-5 h-5"></i>
            Logout
        </button>
    </header>

    <!-- MAIN CONTENT -->
    <main class="flex-grow max-w-6xl mx-auto px-6 py-10">

        <!-- WELCOME SECTION -->
        <div class="mb-10">
            <h2 class="text-3xl font-heading font-bold text-brand-accent-light">
                Welcome, Elliot ðŸ‘‹
            </h2>
            <p class="text-brand-text-mid mt-2">
                Manage your entire mobile music business from one place.
            </p>
        </div>

        <!-- DASHBOARD GRID -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

            <!-- Students -->
            <a href="#" class="block bg-card-bg p-6 rounded-xl card-glow border-t-4 border-brand-accent-light hover-lift">
                <i data-lucide="users" class="w-10 h-10 text-brand-accent-light mb-4"></i>
                <h3 class="text-xl font-bold">Students</h3>
                <p class="text-brand-text-mid text-sm mt-1">View & manage all student profiles.</p>
            </a>

            <!-- Contracts -->
            <a href="#" class="block bg-card-bg p-6 rounded-xl card-glow border-t-4 border-brand-accent-light hover-lift">
                <i data-lucide="file-text" class="w-10 h-10 text-brand-accent-light mb-4"></i>
                <h3 class="text-xl font-bold">Contracts</h3>
                <p class="text-brand-text-mid text-sm mt-1">Upload, sign & track lesson agreements.</p>
            </a>

            <!-- Subscriptions -->
            <a href="#" class="block bg-card-bg p-6 rounded-xl card-glow border-t-4 border-brand-accent-light hover-lift">
                <i data-lucide="shield-check" class="w-10 h-10 text-brand-accent-light mb-4"></i>
                <h3 class="text-xl font-bold">Subscriptions</h3>
                <p class="text-brand-text-mid text-sm mt-1">Manage monthly student subscriptions.</p>
            </a>

            <!-- Invoices -->
            <a href="#" class="block bg-card-bg p-6 rounded-xl card-glow border-t-4 border-brand-accent-light hover-lift">
                <i data-lucide="file-edit" class="w-10 h-10 text-brand-accent-light mb-4"></i>
                <h3 class="text-xl font-bold">Invoices</h3>
                <p class="text-brand-text-mid text-sm mt-1">Track payments & download invoices.</p>
            </a>

            <!-- Lesson Schedule -->
            <a href="#" class="block bg-card-bg p-6 rounded-xl card-glow border-t-4 border-brand-accent-light hover-lift">
                <i data-lucide="calendar" class="w-10 h-10 text-brand-accent-light mb-4"></i>
                <h3 class="text-xl font-bold">Lessons</h3>
                <p class="text-brand-text-mid text-sm mt-1">Manage weekly teaching timetable.</p>
            </a>

            <!-- Resources -->
            <a href="#" class="block bg-card-bg p-6 rounded-xl card-glow border-t-4 border-brand-accent-dark hover-lift">
                <i data-lucide="book-open" class="w-10 h-10 text-brand-accent-light mb-4"></i>
                <h3 class="text-xl font-bold">Resources</h3>
                <p class="text-brand-text-mid text-sm mt-1">Upload lesson sheets, videos & PDF content.</p>
            </a>

            <!-- System Settings -->
            <a href="#" class="block bg-card-bg p-6 rounded-xl card-glow border-t-4 border-brand-highlight hover-lift">
                <i data-lucide="settings" class="w-10 h-10 text-brand-highlight mb-4"></i>
                <h3 class="text-xl font-bold text-brand-highlight">Settings</h3>
                <p class="text-brand-text-mid text-sm mt-1">Admin controls & advanced options.</p>
            </a>

        </div>

    </main>

    <script>
        const supabaseClient = supabase.createClient(
            "https://gorrhpliwhpzndqhzjo.supabase.co",
            "sb_publishable_DrVhz18850mZTf9WPrTyig_zV-j419E"
        );

        // ===========================
        // ðŸ” 1) Check Access
        // ===========================
        async function checkAccess() {
            const { data } = await supabaseClient.auth.getSession();

            if (!data.session) {
                window.location.href = "login.html";
                return;
            }

            const user = data.session.user;

            if (user.user_metadata.role !== "admin") {
                window.location.href = "portal.html";
            }
        }

        checkAccess();

        // ===========================
        // ðŸšª 2) Logout
        // ===========================
        document.getElementById("logout-btn").addEventListener("click", async () => {
            await supabaseClient.auth.signOut();
            window.location.href = "login.html";
        });
    </script>

</body>
</html>
