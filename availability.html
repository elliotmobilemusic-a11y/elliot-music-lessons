<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Availability – Elliot Wardill Mobile Music Lessons</title>
    <link rel="icon" href="/favicon.png" type="image/png" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-dark-bg': '#1a1a2e',
                        'brand-accent-light': '#00d084',
                        'brand-accent-dark': '#00a36e',
                        'brand-text-light': '#e0e0e0',
                        'brand-text-mid': '#a0e0e0',
                        'brand-highlight': '#ffb703',
                        'card-bg': '#252538',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Montserrat', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@700;800;900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a2e;
            background-image: radial-gradient(circle at 100% 100%, #252538 0%, #1a1a2e 70%);
            color: #e0e0e0;
        }

        .card-glow {
            box-shadow: 0 10px 30px rgba(0, 208, 132, 0.12), 0 3px 10px rgba(0, 0, 0, 0.6);
        }

        .hover-lift {
            transition:
                transform 0.25s ease,
                box-shadow 0.25s ease,
                border-color 0.2s ease,
                background-color 0.2s ease;
        }
        .hover-lift:hover {
            transform: translateY(-4px);
        }

        .main-hero-shadow {
            text-shadow: 0 0 16px rgba(0, 208, 132, 0.4);
        }

        /* Reveal animation */
        .reveal {
            opacity: 0;
            transform: translateY(24px);
            transition:
                opacity 0.8s ease-out,
                transform 0.8s ease-out;
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .reveal.delayed-1 { transition-delay: 0.12s; }
        .reveal.delayed-2 { transition-delay: 0.18s; }

        .badge {
            display: inline-flex;
            align-items: center;
            border-radius: 999px;
            padding: 0.25rem 0.6rem;
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.04em;
            text-transform: uppercase;
        }
    </style>

    <!-- Lucide Icons -->
    <script type="module">
        import {
            createIcons,
            Music2,
            Clock,
            Calendar,
            XCircle,
            Users,
            Mail,
            Phone,
            AlertTriangle
        } from 'https://cdn.jsdelivr.net/npm/lucide@latest/dist/esm/lucide.js';

        createIcons({
            icons: { Music2, Clock, Calendar, XCircle, Users, Mail, Phone, AlertTriangle }
        });
    </script>
</head>
<body class="min-h-screen flex flex-col text-brand-text-light">

    <!-- NAVIGATION (matches home/pricing) -->
    <nav class="bg-brand-dark-bg/90 backdrop-blur border-b border-brand-accent-dark/40 text-white sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <a href="index.html" class="flex items-center space-x-2">
                    <span class="inline-flex items-center justify-center w-9 h-9 rounded-full bg-brand-accent-light/10 border border-brand-accent-light/50">
                        <i data-lucide="music-2" class="w-5 h-5 text-brand-accent-light"></i>
                    </span>
                    <span class="text-sm sm:text-base font-heading font-extrabold tracking-[0.18em] text-brand-highlight">
                        ELLIOT'S MOBILE MUSIC
                    </span>
                </a>

                <!-- Desktop nav -->
                <div class="hidden sm:flex sm:space-x-4 text-xs md:text-sm">
                    <a href="index.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium hover-lift">
                        HOME
                    </a>
                    <a href="pricing.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium hover-lift">
                        PRICING & FEES
                    </a>
                    <a href="availability.html" class="border-b-2 border-brand-accent-light text-brand-accent-light px-3 py-2 font-medium hover-lift">
                        AVAILABILITY
                    </a>
                    <a href="contact.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium hover-lift">
                        CONTACT
                    </a>
                </div>

                <!-- Mobile button -->
                <div class="sm:hidden">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-300 hover:text-white hover:bg-brand-accent-dark focus:outline-none focus:ring-2 focus:ring-white">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile menu -->
        <div class="sm:hidden hidden" id="mobile-menu">
            <div class="pt-2 pb-3 space-y-1 px-3 text-sm">
                <a href="index.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">HOME</a>
                <a href="pricing.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">PRICING & FEES</a>
                <a href="availability.html" class="block rounded-md bg-brand-accent-dark text-white px-3 py-2 font-medium">AVAILABILITY</a>
                <a href="contact.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">CONTACT</a>
            </div>
        </div>
    </nav>

    <!-- MAIN -->
    <main class="flex-grow">
        <!-- HERO -->
        <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 sm:pt-24 pb-10">
            <div class="text-center max-w-3xl mx-auto mb-8 reveal">
                <p class="text-xs font-semibold tracking-[0.25em] text-brand-highlight mb-3 uppercase">
                    LIVE AVAILABILITY OVERVIEW
                </p>
                <h1 class="font-heading text-4xl sm:text-5xl lg:text-6xl font-extrabold text-brand-text-light main-hero-shadow mb-4">
                    Current Lesson Availability
                </h1>
                <p class="text-base sm:text-lg text-brand-text-mid">
                    See which days Elliot is teaching, which days are by request, and when the studio is closed for holidays.
                </p>
            </div>

            <!-- Mode + summary strip -->
            <div class="max-w-4xl mx-auto space-y-4 reveal delayed-1">
                <!-- Mode toggle -->
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 bg-card-bg/80 border border-brand-accent-dark/60 rounded-2xl px-4 py-3 card-glow">
                    <div class="text-xs sm:text-sm text-brand-text-mid">
                        <p id="today-line" class="font-semibold text-brand-text-light mb-1">
                            <!-- Filled by JS -->
                        </p>
                        <p id="mode-description">
                            <!-- Filled by JS -->
                        </p>
                    </div>
                    <div class="flex items-center gap-2 text-xs sm:text-sm">
                        <span class="text-brand-text-mid mr-1">View as:</span>
                        <button
                            id="mode-term"
                            class="px-3 py-1.5 rounded-full border border-brand-accent-light/60 bg-brand-accent-light/15 text-brand-accent-light font-semibold hover:bg-brand-accent-light/30 transition"
                        >
                            Term Time
                        </button>
                        <button
                            id="mode-holiday"
                            class="px-3 py-1.5 rounded-full border border-brand-accent-dark/40 bg-transparent text-brand-text-mid font-semibold hover:bg-brand-accent-dark/40 hover:text-brand-text-light transition"
                        >
                            School Holidays
                        </button>
                    </div>
                </div>

                <!-- Next available -->
                <div class="max-w-4xl mx-auto bg-card-bg/90 border border-brand-accent-dark/60 rounded-2xl px-4 py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 card-glow">
                    <div class="flex items-center gap-2 text-xs sm:text-sm">
                        <i data-lucide="clock" class="w-5 h-5 text-brand-accent-light"></i>
                        <div>
                            <p class="font-semibold text-brand-text-light">Next available regular slot</p>
                            <p id="next-slot-line" class="text-brand-text-mid">
                                <!-- Filled by JS -->
                            </p>
                        </div>
                    </div>
                    <div class="text-xs sm:text-sm text-brand-text-mid">
                        <p>
                            For weekend or special requests, please use the <a href="contact.html" class="text-brand-accent-light hover:text-white underline">contact page</a>.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- AVAILABILITY GRID -->
        <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-20">
            <div id="break-banner" class="max-w-4xl mx-auto mb-6 hidden reveal">
                <div class="flex items-start gap-3 bg-[#4b2b20] border border-[#ffb703]/60 text-xs sm:text-sm text-[#ffe2a6] px-4 py-3 rounded-xl card-glow">
                    <i data-lucide="alert-triangle" class="w-5 h-5 flex-shrink-0 mt-0.5"></i>
                    <p>
                        <strong>End-of-year break:</strong> Lessons are paused between
                        <strong>22 December and 2 January</strong>. You can still send enquiries, and lessons resume from
                        <strong>3 January</strong>.
                    </p>
                </div>
            </div>

            <div id="availability-grid" class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-5 reveal delayed-2">
                <!-- Cards generated by JS -->
            </div>

            <!-- Key -->
            <div class="max-w-4xl mx-auto mt-8 text-[0.75rem] sm:text-xs text-brand-text-mid space-y-2 reveal">
                <div class="flex flex-wrap gap-3">
                    <span class="badge bg-brand-accent-light/15 border border-brand-accent-light/50 text-brand-accent-light">
                        AVAILABLE
                    </span>
                    <span class="badge bg-brand-highlight/15 border border-brand-highlight/60 text-brand-highlight">
                        BY REQUEST
                    </span>
                    <span class="badge bg-red-900/40 border border-red-500/70 text-red-200">
                        UNAVAILABLE / CLOSED
                    </span>
                </div>
                <p>
                    Availability may change during busy periods or school terms. Exact times are always confirmed directly with Elliot when you book.
                </p>
            </div>
        </section>

        <!-- CONTACT CTA -->
        <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-24">
            <div class="max-w-4xl mx-auto bg-card-bg/90 border border-brand-accent-dark/60 rounded-2xl p-6 sm:p-7 flex flex-col md:flex-row gap-5 items-start md:items-center card-glow reveal">
                <div class="flex-1 text-sm sm:text-base">
                    <h2 class="font-heading text-xl sm:text-2xl font-bold text-brand-accent-light mb-1 flex items-center gap-2">
                        <i data-lucide="users" class="w-5 h-5 text-brand-accent-light"></i>
                        Ready to book a lesson?
                    </h2>
                    <p class="text-brand-text-mid">
                        Send a quick message with your preferred days, times and postcode. I’ll confirm the closest available slot
                        and your full price, including travel.
                    </p>
                    <p class="mt-2 text-xs text-brand-text-mid">
                        You can also text or call directly if that’s easier.
                    </p>
                    <div class="mt-3 flex flex-wrap gap-4 text-xs sm:text-sm text-brand-text-mid">
                        <span class="inline-flex items-center gap-1">
                            <i data-lucide="phone" class="w-4 h-4 text-brand-highlight"></i>
                            <a href="tel:07368975144" class="hover:text-white">07368 975144</a>
                        </span>
                        <span class="inline-flex items-center gap-1">
                            <i data-lucide="mail" class="w-4 h-4 text-brand-accent-light"></i>
                            <a href="mailto:elliotmobilemusic@gmail.com" class="hover:text-white">elliotmobilemusic@gmail.com</a>
                        </span>
                    </div>
                </div>
                <div class="flex-shrink-0">
                    <a
                        href="contact.html"
                        class="inline-flex items-center justify-center px-5 py-3 rounded-lg bg-brand-accent-light text-brand-dark-bg text-sm font-semibold shadow-lg shadow-brand-accent-light/30 hover:bg-brand-accent-dark transform hover:scale-[1.02] transition"
                    >
                        Enquire via Contact Page
                    </a>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-900 text-brand-text-mid py-7 mt-2">
        <div class="max-w-6xl mx-auto px-4 text-center text-xs sm:text-sm">
            <p>&copy; 2024 Elliot Wardill Mobile Music Lessons. All rights reserved.</p>
            <p class="mt-1 text-gray-500">
                DBS Checked & Insured. Full lesson policy and travel information available on the pricing page.
            </p>
        </div>
    </footer>

    <!-- JS: UI + Rule-based smart availability -->
    <script>
        // ===== Mobile menu =====
        document.getElementById('mobile-menu-button').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        // ===== Reveal on scroll =====
        const revealElements = document.querySelectorAll('.reveal');
        if (revealElements.length) {
            const revealObserver = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            revealObserver.unobserve(entry.target);
                        }
                    });
                },
                { threshold: 0.12 }
            );
            revealElements.forEach(el => revealObserver.observe(el));
        }

        // ===== Rule-based availability config =====
        // Types:
        //  - "available"   => normal teaching hours
        //  - "request"     => available by request (weekends etc.)
        //  - "unavailable" => no lessons

        const SCHEDULES = {
            term: {
                monday:    { type: 'unavailable' },
                tuesday:   { type: 'available', start: '18:00', end: '21:00' },
                wednesday: { type: 'available', start: '18:00', end: '21:00' },
                thursday:  { type: 'available', start: '18:00', end: '21:00' },
                friday:    { type: 'unavailable' },
                saturday:  { type: 'request',   label: 'By request – message to arrange' },
                sunday:    { type: 'request',   label: 'By request – message to arrange' },
            },
            holiday: {
                // Holiday weeks: weekends become fully open, weekdays stay the same.
                monday:    { type: 'unavailable' },
                tuesday:   { type: 'available', start: '18:00', end: '21:00' },
                wednesday: { type: 'available', start: '18:00', end: '21:00' },
                thursday:  { type: 'available', start: '18:00', end: '21:00' },
                friday:    { type: 'unavailable' },
                saturday:  { type: 'available', start: '10:00', end: '16:00', note: 'Times flexible in school holidays' },
                sunday:    { type: 'available', start: '11:00', end: '16:00', note: 'Times flexible in school holidays' },
            }
        };

        // End-of-year break (22 Dec – 2 Jan, any year)
        function isEndOfYearBreak(date) {
            const d = date.getDate();
            const m = date.getMonth(); // 0 = Jan, 11 = Dec
            // 22–31 December OR 1–2 January
            return (m === 11 && d >= 22) || (m === 0 && d <= 2);
        }

        const DAY_ORDER = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
        const DAY_LABELS = {
            monday: 'Monday',
            tuesday: 'Tuesday',
            wednesday: 'Wednesday',
            thursday: 'Thursday',
            friday: 'Friday',
            saturday: 'Saturday',
            sunday: 'Sunday',
        };

        const availabilityGrid = document.getElementById('availability-grid');
        const todayLine = document.getElementById('today-line');
        const modeDescription = document.getElementById('mode-description');
        const nextSlotLine = document.getElementById('next-slot-line');
        const breakBanner = document.getElementById('break-banner');

        const btnTerm = document.getElementById('mode-term');
        const btnHoliday = document.getElementById('mode-holiday');

        let currentMode = 'term'; // "term" or "holiday"
        const today = new Date();

        // If we're in the 22 Dec – 2 Jan break, we start in "closed" state.
        const currentlyOnBreak = isEndOfYearBreak(today);

        function formatTime24to12(timeStr) {
            // "18:00" -> "6:00 PM"
            if (!timeStr) return '';
            const [hStr, mStr] = timeStr.split(':');
            let h = parseInt(hStr, 10);
            const m = mStr || '00';
            const suffix = h >= 12 ? 'PM' : 'AM';
            if (h === 0) h = 12;
            else if (h > 12) h -= 12;
            return `${h}:${m} ${suffix}`;
        }

        function isToday(dayKey, refDate = today) {
            const dow = refDate.getDay(); // 0 = Sunday ... 6 = Saturday
            const map = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            return map[dow] === dayKey;
        }

        function findNextAvailableSlot(mode, fromDate = today) {
            // Look ahead up to 14 days
            for (let i = 0; i < 14; i++) {
                const d = new Date(fromDate);
                d.setDate(fromDate.getDate() + i);

                if (isEndOfYearBreak(d)) continue;

                const dow = d.getDay();
                const map = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                const dayKey = map[dow];
                const schedule = SCHEDULES[mode][dayKey];

                if (!schedule) continue;

                if (schedule.type === 'available') {
                    return {
                        date: d,
                        dayKey,
                        kind: 'regular',
                        start: schedule.start,
                        end: schedule.end,
                    };
                }
            }

            // If no regular slot, try "request" days as a softer fallback
            for (let i = 0; i < 14; i++) {
                const d = new Date(fromDate);
                d.setDate(fromDate.getDate() + i);

                if (isEndOfYearBreak(d)) continue;

                const dow = d.getDay();
                const map = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                const dayKey = map[dow];
                const schedule = SCHEDULES[mode][dayKey];

                if (!schedule) continue;

                if (schedule.type === 'request') {
                    return {
                        date: d,
                        dayKey,
                        kind: 'request',
                        label: schedule.label || 'Available on request',
                    };
                }
            }

            return null;
        }

        function updateModeButtons() {
            if (currentlyOnBreak) {
                btnTerm.disabled = true;
                btnHoliday.disabled = true;
                btnTerm.classList.add('opacity-60', 'cursor-not-allowed');
                btnHoliday.classList.add('opacity-60', 'cursor-not-allowed');
                modeDescription.textContent =
                    'Lessons are currently paused for the end-of-year break. Availability returns from 3 January.';
                return;
            }

            btnTerm.disabled = false;
            btnHoliday.disabled = false;
            btnTerm.classList.remove('opacity-60', 'cursor-not-allowed');
            btnHoliday.classList.remove('opacity-60', 'cursor-not-allowed');

            if (currentMode === 'term') {
                btnTerm.classList.add('bg-brand-accent-light/15', 'border-brand-accent-light/60', 'text-brand-accent-light');
                btnTerm.classList.remove('bg-transparent', 'text-brand-text-mid');

                btnHoliday.classList.add('bg-transparent', 'text-brand-text-mid');
                btnHoliday.classList.remove('bg-brand-accent-light/15', 'border-brand-accent-light/60', 'text-brand-accent-light');

                modeDescription.textContent =
                    'Showing standard term-time evenings: Tuesday–Thursday 6–9pm, with weekends available by request.';
            } else {
                btnHoliday.classList.add('bg-brand-accent-light/15', 'border-brand-accent-light/60', 'text-brand-accent-light');
                btnHoliday.classList.remove('bg-transparent', 'text-brand-text-mid');

                btnTerm.classList.add('bg-transparent', 'text-brand-text-mid');
                btnTerm.classList.remove('bg-brand-accent-light/15', 'border-brand-accent-light/60', 'text-brand-accent-light');

                modeDescription.textContent =
                    'Showing school holiday view: evenings midweek plus more flexible weekend daytime slots.';
            }
        }

        function renderTodayLine() {
            const todayLabel = today.toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'short' });
            if (currentlyOnBreak) {
                todayLine.textContent = `Today: ${todayLabel} – no lessons (end-of-year break).`;
                return;
            }

            const dow = today.getDay();
            const map = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const dayName = map[dow];

            let schedule = SCHEDULES[currentMode];
            const key = dayName.toLowerCase();
            const info = schedule[key];

            if (!info || info.type === 'unavailable') {
                todayLine.textContent = `Today: ${todayLabel} – no regular lesson slots.`;
            } else if (info.type === 'available') {
                todayLine.textContent = `Today: ${todayLabel} – available between ${formatTime24to12(info.start)} and ${formatTime24to12(info.end)}.`;
            } else if (info.type === 'request') {
                todayLine.textContent = `Today: ${todayLabel} – available by request. Send a quick message to check a time.`;
            }
        }

        function renderNextSlotLine() {
            if (currentlyOnBreak) {
                nextSlotLine.textContent = 'Lessons resume from 3 January. You can still send booking enquiries in the meantime.';
                return;
            }

            const result = findNextAvailableSlot(currentMode, today);
            if (!result) {
                nextSlotLine.textContent = 'No upcoming regular slots found in the next 2 weeks. Please contact Elliot to check manually.';
                return;
            }

            const d = result.date;
            const labelDay = d.toLocaleDateString('en-GB', {
                weekday: 'long',
                day: 'numeric',
                month: 'short'
            });

            if (result.kind === 'regular') {
                nextSlotLine.innerHTML = `
                    <span class="text-brand-text-light font-semibold">${labelDay}</span> ·
                    <span>${formatTime24to12(result.start)} – ${formatTime24to12(result.end)}</span>
                `;
            } else {
                nextSlotLine.innerHTML = `
                    <span class="text-brand-text-light font-semibold">${labelDay}</span> ·
                    <span>Available by request – send a message to confirm a time.</span>
                `;
            }
        }

        function renderGrid() {
            availabilityGrid.innerHTML = '';

            const isBreak = currentlyOnBreak;
            const schedule = SCHEDULES[currentMode];

            DAY_ORDER.forEach((dayKey) => {
                const label = DAY_LABELS[dayKey];
                let info = schedule[dayKey];

                let type, title, subtitle, badgeText, badgeClass, borderClass;

                if (isBreak) {
                    type = 'unavailable';
                    title = label;
                    subtitle = 'Closed for end-of-year break.';
                    badgeText = 'CLOSED';
                    badgeClass = 'bg-red-900/40 border-red-500/70 text-red-200';
                    borderClass = 'border-red-500/80';
                } else if (!info || info.type === 'unavailable') {
                    type = 'unavailable';
                    title = label;
                    subtitle = 'No lessons on this day.';
                    badgeText = 'UNAVAILABLE';
                    badgeClass = 'bg-red-900/40 border-red-500/70 text-red-200';
                    borderClass = 'border-red-500/80';
                } else if (info.type === 'available') {
                    type = 'available';
                    title = label;
                    const timeRange = `${formatTime24to12(info.start)} – ${formatTime24to12(info.end)}`;
                    subtitle = `Regular slot: ${timeRange}`;
                    badgeText = 'AVAILABLE';
                    badgeClass = 'bg-brand-accent-light/15 border-brand-accent-light/60 text-brand-accent-light';
                    borderClass = 'border-brand-accent-light';
                } else {
                    type = 'request';
                    title = label;
                    subtitle = info.label || info.note || 'Available by request – contact to arrange a time.';
                    badgeText = 'BY REQUEST';
                    badgeClass = 'bg-brand-highlight/15 border-brand-highlight/70 text-brand-highlight';
                    borderClass = 'border-brand-highlight';
                }

                const isTodayCard = isToday(dayKey);

                const card = document.createElement('article');
                card.className =
                    'relative bg-card-bg/90 rounded-2xl card-glow border border-brand-accent-dark/60 p-5 sm:p-6 hover-lift flex flex-col gap-2';
                if (isTodayCard) {
                    card.classList.add('ring-1', 'ring-brand-accent-light/60');
                }

                card.innerHTML = `
                    <div class="flex items-center justify-between gap-2 mb-1">
                        <div>
                            <h3 class="font-heading text-lg sm:text-xl font-bold text-brand-text-light">
                                ${title}
                            </h3>
                            <p class="text-[0.75rem] text-brand-text-mid mt-0.5">
                                ${type === 'available'
                                    ? 'Regular teaching evening.'
                                    : type === 'request'
                                        ? 'Availability can vary – message to check.'
                                        : 'No regular teaching on this day.'}
                            </p>
                        </div>
                        <div class="flex flex-col items-end gap-1">
                            <span class="badge ${badgeClass}">
                                ${badgeText}
                            </span>
                            ${
                                isTodayCard
                                    ? '<span class="badge bg-brand-accent-light/10 border border-brand-accent-light/40 text-brand-accent-light">TODAY</span>'
                                    : ''
                            }
                        </div>
                    </div>
                    <div class="mt-2 pt-3 border-t ${borderClass}/50 text-xs sm:text-sm text-brand-text-mid">
                        ${
                            type === 'available'
                                ? `<p><strong class="text-brand-text-light">Typical slot:</strong> ${formatTime24to12(
                                      info.start
                                  )} – ${formatTime24to12(info.end)}</p>`
                                : type === 'request'
                                    ? `<p>${subtitle}</p>`
                                    : `<p>${subtitle}</p>`
                        }
                        ${
                            info && info.note && !isBreak
                                ? `<p class="mt-1 text-[0.7rem] text-brand-text-mid">${info.note}</p>`
                                : ''
                        }
                    </div>
                `;

                availabilityGrid.appendChild(card);
            });
        }

        // ===== Initialise =====
        if (currentlyOnBreak) {
            breakBanner.classList.remove('hidden');
        }

        function rerenderAll() {
            updateModeButtons();
            renderTodayLine();
            renderNextSlotLine();
            renderGrid();
        }

        // Mode buttons
        btnTerm.addEventListener('click', () => {
            if (currentlyOnBreak) return;
            currentMode = 'term';
            rerenderAll();
        });
        btnHoliday.addEventListener('click', () => {
            if (currentlyOnBreak) return;
            currentMode = 'holiday';
            rerenderAll();
        });

        // First render
        rerenderAll();
    </script>
</body>
</html>
