<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Availability ‚Äì Elliot Wardill Mobile Music Lessons</title>
    <link rel="icon" href="/favicon.png" type="image/png" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-dark-bg': '#1a1a2e',
                        'brand-accent-light': '#00d084',
                        'brand-accent-dark': '#00a36e',
                        'brand-text-light': '#e0e0e0',
                        'brand-text-mid': '#a0e0e0',
                        'brand-highlight': '#ffb703',
                        'card-bg': '#252538',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Montserrat', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@700;800;900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a2e;
            background-image: radial-gradient(circle at 100% 100%, #252538 0%, #1a1a2e 70%);
            color: #e0e0e0;
        }
        .card-glow {
            box-shadow: 0 10px 30px rgba(0, 208, 132, 0.12), 0 3px 10px rgba(0, 0, 0, 0.6);
        }
        .hover-lift {
            transition:
                transform 0.25s ease,
                box-shadow 0.25s ease,
                border-color 0.2s ease,
                background-color 0.2s ease;
        }
        .hover-lift:hover {
            transform: translateY(-4px);
        }
        .main-hero-shadow {
            text-shadow: 0 0 16px rgba(0, 208, 132, 0.4);
        }

        /* Reveal animation */
        .reveal {
            opacity: 0;
            transform: translateY(24px);
            transition:
                opacity 0.8s ease-out,
                transform 0.8s ease-out;
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .reveal.delayed-1 { transition-delay: 0.12s; }
        .reveal.delayed-2 { transition-delay: 0.18s; }

        /* Availability slot pills */
        .slot-pill {
            cursor: pointer;
            transition:
                transform 0.15s ease,
                box-shadow 0.15s ease,
                background-color 0.15s ease,
                border-color 0.15s ease;
        }
        .slot-pill:hover {
            transform: translateY(-2px);
        }
        .slot-pill.disabled {
            cursor: not-allowed;
            opacity: 0.35;
        }

        /* Badge */
        .badge {
            display: inline-flex;
            align-items: center;
            border-radius: 999px;
            padding: 0.25rem 0.6rem;
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.04em;
            text-transform: uppercase;
        }
    </style>

    <!-- Lucide Icons -->
    <script type="module">
        import {
            createIcons,
            Zap,
            BookOpen,
            Clock,
            Mail,
            Phone,
            MapPin,
            MessageSquare,
            Star,
            Users,
            Send,
            Calendar,
            XCircle
        } from 'https://cdn.jsdelivr.net/npm/lucide@latest/dist/esm/lucide.js';

        createIcons({
            icons: {
                Zap,
                BookOpen,
                Clock,
                Mail,
                Phone,
                MapPin,
                MessageSquare,
                Star,
                Users,
                Send,
                Calendar,
                XCircle
            }
        });
    </script>
</head>
<body class="min-h-screen flex flex-col text-brand-text-light">
    <!-- NAVIGATION -->
    <nav class="bg-brand-dark-bg/90 backdrop-blur border-b border-brand-accent-dark/40 text-white sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <a href="index.html" class="flex items-center space-x-2">
                    <span class="inline-flex items-center justify-center w-9 h-9 rounded-full bg-brand-accent-light/10 border border-brand-accent-light/50">
                        <!-- same icon as Home & Pricing -->
                        <i data-lucide="music-2" class="w-5 h-5 text-brand-accent-light"></i>
                    </span>
                    <span class="text-sm sm:text-base font-heading font-extrabold tracking-[0.18em] text-brand-highlight">
                        ELLIOT'S MOBILE MUSIC
                    </span>
                </a>

                <!-- Desktop nav -->
                <div class="hidden sm:flex sm:space-x-4 text-xs md:text-sm">
                    <a href="index.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium hover-lift">
                        HOME
                    </a>
                    <a href="pricing.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium hover-lift">
                        PRICING & FEES
                    </a>
                    <a href="availability.html" class="border-b-2 border-brand-accent-light text-brand-accent-light px-3 py-2 font-medium hover-lift">
                        AVAILABILITY
                    </a>
                    <a href="contact.html" class="border-b-2 border-transparent hover:border-brand-accent-light hover:text-white text-brand-text-mid px-3 py-2 font-medium hover-lift">
                        CONTACT
                    </a>
                </div>

                <!-- Mobile button -->
                <div class="sm:hidden">
                    <button
                        id="mobile-menu-button"
                        class="inline-flex items-center justify-center p-2 rounded-md text-gray-300 hover:text-white hover:bg-brand-accent-dark focus:outline-none focus:ring-2 focus:ring-white"
                    >
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile menu -->
        <div class="sm:hidden hidden" id="mobile-menu">
            <div class="pt-2 pb-3 space-y-1 px-3 text-sm">
                <a href="index.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">HOME</a>
                <a href="pricing.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">PRICING & FEES</a>
                <a href="availability.html" class="block rounded-md bg-brand-accent-dark text-white px-3 py-2 font-medium">AVAILABILITY</a>
                <a href="contact.html" class="block rounded-md text-brand-text-mid hover:bg-brand-accent-dark px-3 py-2 font-medium">CONTACT</a>
            </div>
        </div>
    </nav>

    <!-- MAIN -->
    <main class="flex-grow">
        <!-- HERO -->
        <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 sm:pt-24 pb-10">
            <div class="text-center max-w-3xl mx-auto mb-8 reveal">
                <p class="text-xs font-semibold tracking-[0.25em] text-brand-highlight mb-3 uppercase">
                    LIVE EVENING AVAILABILITY
                </p>
                <h1 class="font-heading text-4xl sm:text-5xl lg:text-6xl font-extrabold text-brand-text-light main-hero-shadow mb-4">
                    Current Lesson Availability
                </h1>
                <p class="text-base sm:text-lg text-brand-text-mid">
                    This page shows a live view of my typical evening availability for <strong>mobile piano & singing lessons</strong> from Pudsey.
                    Click a slot to send a request for that time.
                </p>
            </div>

            <!-- Highlight row -->
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-4xl mx-auto reveal delayed-1">
                <div class="flex items-center justify-center gap-2 text-xs sm:text-sm text-brand-text-mid bg-card-bg/80 rounded-xl px-4 py-3 border border-brand-accent-dark/50">
                    <i data-lucide="clock" class="w-4 h-4 text-brand-accent-light"></i>
                    <span>Evenings: Tue, Wed & Thu</span>
                </div>
                <div class="flex items-center justify-center gap-2 text-xs sm:text-sm text-brand-text-mid bg-card-bg/80 rounded-xl px-4 py-3 border border-brand-accent-dark/50">
                    <i data-lucide="calendar" class="w-4 h-4 text-brand-highlight"></i>
                    <span>1-hour blocks between 6‚Äì9pm</span>
                </div>
                <div class="flex items-center justify-center gap-2 text-xs sm:text-sm text-brand-text-mid bg-card-bg/80 rounded-xl px-4 py-3 border border-brand-accent-dark/50">
                    <i data-lucide="mail" class="w-4 h-4 text-brand-accent-light"></i>
                    <span>Click a slot to request it</span>
                </div>
            </div>
        </section>

        <!-- AVAILABILITY GRID + SLOT DETAILS -->
        <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-20">
            <div class="grid grid-cols-1 lg:grid-cols-[1.3fr_minmax(0,1fr)] gap-10 lg:gap-12 items-start">
                <!-- LEFT: DYNAMIC GRID -->
                <section class="p-6 sm:p-7 bg-card-bg/90 rounded-2xl card-glow border border-brand-accent-dark/60 reveal">
                    <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between mb-4">
                        <div>
                            <h2 class="font-heading text-2xl sm:text-3xl font-bold text-brand-accent-light flex items-center gap-2">
                                <i data-lucide="calendar" class="w-6 h-6 text-brand-highlight"></i>
                                Weekly Evening Calendar
                            </h2>
                            <p class="text-xs sm:text-sm text-brand-text-mid mt-1 max-w-md">
                                View evening availability for <strong>this week</strong> and move forwards or backwards a week.
                                This is a guide ‚Äì I‚Äôll always confirm times directly with you.
                            </p>
                        </div>
                        <div class="flex items-center gap-2">
                            <button
                                id="prev-week"
                                class="px-3 py-1.5 rounded-lg border border-brand-text-mid/40 text-xs sm:text-sm text-brand-text-mid bg-brand-dark-bg hover:bg-brand-dark-bg/80 hover:text-white"
                            >
                                ‚Üê Previous week
                            </button>
                            <button
                                id="next-week"
                                class="px-3 py-1.5 rounded-lg border border-brand-accent-light/60 text-xs sm:text-sm text-brand-dark-bg bg-brand-accent-light hover:bg-brand-accent-dark font-semibold"
                            >
                                Next week ‚Üí
                            </button>
                        </div>
                    </div>

                    <div class="flex items-center justify-between mb-3">
                        <p class="text-xs sm:text-sm text-brand-text-mid">
                            Showing evenings for the week of
                            <span id="week-label" class="font-semibold text-brand-text-light"></span>
                        </p>
                        <span class="badge bg-brand-accent-light/10 text-brand-accent-light border border-brand-accent-light/40">
                            1-HOUR BLOCKS
                        </span>
                    </div>

                    <!-- Legend -->
                    <div class="flex flex-wrap items-center gap-3 text-[0.7rem] text-brand-text-mid mb-4">
                        <span class="inline-flex items-center gap-1">
                            <span class="inline-block w-3 h-3 rounded-full bg-brand-accent-light/40 border border-brand-accent-light/80"></span>
                            Available
                        </span>
                        <span class="inline-flex items-center gap-1">
                            <span class="inline-block w-3 h-3 rounded-full bg-red-900/40 border border-red-500/70"></span>
                            Unavailable / booked / past
                        </span>
                        <span class="inline-flex items-center gap-1">
                            <span class="inline-block w-3 h-3 rounded-full bg-gray-600/40 border border-gray-500/70"></span>
                            Day not in teaching schedule
                        </span>
                    </div>

                    <!-- Grid container -->
                    <div id="slots-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4 text-xs sm:text-sm">
                        <!-- JS will inject cards here -->
                    </div>

                    <p class="mt-5 text-[0.7rem] text-brand-text-mid">
                        Availability is usually accurate but can change with school terms, holidays, and existing students.
                        I‚Äôll always confirm your booking personally once you send a request.
                    </p>
                </section>

                <!-- RIGHT: SELECTED SLOT + NOTES -->
                <section class="space-y-6 reveal delayed-1">
                    <!-- Selected slot card -->
                    <div id="selected-slot-card" class="bg-card-bg/90 rounded-2xl card-glow border border-brand-accent-dark/60 p-5 hidden">
                        <h3 class="font-heading text-xl sm:text-2xl font-bold text-brand-highlight mb-2">
                            Request this time
                        </h3>
                        <p id="selected-slot-text" class="text-xs sm:text-sm text-brand-text-mid mb-4">
                            Click an available slot on the left to see details here.
                        </p>

                        <div class="mb-4">
                            <p class="text-[0.75rem] font-semibold tracking-[0.12em] uppercase text-brand-text-mid mb-1">
                                Choose lesson length
                            </p>
                            <div class="flex flex-wrap gap-2">
                                <button
                                    class="lesson-length-btn px-3 py-1.5 rounded-full border border-brand-text-mid/60 text-xs text-brand-text-mid bg-brand-dark-bg hover:bg-brand-accent-light/10"
                                    data-minutes="30"
                                >
                                    30 minutes (¬£15)
                                </button>
                                <button
                                    class="lesson-length-btn px-3 py-1.5 rounded-full border border-brand-text-mid/60 text-xs text-brand-text-mid bg-brand-dark-bg hover:bg-brand-accent-light/10"
                                    data-minutes="60"
                                >
                                    60 minutes (¬£30)
                                </button>
                                <button
                                    class="lesson-length-btn px-3 py-1.5 rounded-full border border-brand-text-mid/60 text-xs text-brand-text-mid bg-brand-dark-bg hover:bg-brand-accent-light/10"
                                    data-minutes="90"
                                >
                                    90 minutes (¬£50)
                                </button>
                            </div>
                        </div>

                        <button
                            id="email-request-btn"
                            class="w-full px-4 py-2.5 rounded-lg bg-brand-accent-light hover:bg-brand-accent-dark text-sm font-semibold text-brand-dark-bg flex items-center justify-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed"
                            disabled
                        >
                            <i data-lucide="mail" class="w-4 h-4"></i>
                            Email Elliot about this slot
                        </button>

                        <p class="mt-3 text-[0.7rem] text-brand-text-mid">
                            This will open your email app with a pre-filled message including the date, time, and your chosen lesson length.
                            You can edit the message before sending.
                        </p>
                    </div>

                    <!-- Weekend & other notes -->
                    <div class="bg-card-bg/90 rounded-2xl card-glow border-l-4 border-brand-highlight border border-brand-accent-dark/60 p-5">
                        <h3 class="font-heading text-xl font-bold text-brand-accent-light mb-2 flex items-center gap-2">
                            <span class="text-brand-highlight text-lg">üìÜ</span>
                            Weekends & exceptions
                        </h3>
                        <p class="text-xs sm:text-sm text-brand-text-mid mb-2">
                            <strong>Saturday & Sunday</strong> are sometimes available on request, especially outside normal school terms.
                        </p>
                        <p class="text-xs sm:text-sm text-brand-text-mid">
                            <span class="text-brand-highlight font-semibold">End-of-year break:</span>
                            around <strong>22 December ‚Äì 2 January</strong>, I usually pause all lessons for the holidays.
                            Exact dates will always be confirmed in advance with current students.
                        </p>
                    </div>

                    <div class="bg-card-bg/90 rounded-2xl card-glow border border-brand-accent-dark/60 p-5 text-xs sm:text-sm">
                        <p class="font-semibold text-brand-text-light mb-1">
                            Need a different time?
                        </p>
                        <p class="text-brand-text-mid mb-2">
                            If you don‚Äôt see the time you‚Äôre hoping for, send me a quick message and I‚Äôll let you know if there‚Äôs any flexibility.
                        </p>
                        <p class="text-brand-text-mid">
                            Phone: <a href="tel:07368975144" class="text-brand-accent-light hover:text-white">07368 975144</a><br />
                            Email: <a href="mailto:elliotmobilemusic@gmail.com" class="text-brand-accent-light hover:text-white">elliotmobilemusic@gmail.com</a>
                        </p>
                    </div>
                </section>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-900 text-brand-text-mid py-7 mt-2">
        <div class="max-w-6xl mx-auto px-4 text-center text-xs sm:text-sm">
            <p>&copy; 2024 Elliot Wardill Mobile Music Lessons. All rights reserved.</p>
            <p class="mt-1 text-gray-500">
                DBS Checked & Insured. Availability may change during school holidays and term time.
            </p>
        </div>
    </footer>

    <!-- JS: UI + DYNAMIC WEEK LOGIC -->
    <script>
        // Mobile menu
        document.getElementById('mobile-menu-button').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        // Reveal on scroll
        const revealElements = document.querySelectorAll('.reveal');
        if (revealElements.length) {
            const revealObserver = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            revealObserver.unobserve(entry.target);
                        }
                    });
                },
                { threshold: 0.12 }
            );
            revealElements.forEach(el => revealObserver.observe(el));
        }

        // ============ AVAILABILITY LOGIC (1-HOUR BLOCKS) ============

        // Teaching evenings: Tue, Wed, Thu ‚Äì 6-9pm (one-hour blocks)
        const TEACHING_DAYS = [
            { weekday: 2, label: 'Tuesday' },
            { weekday: 3, label: 'Wednesday' },
            { weekday: 4, label: 'Thursday' }
        ];
        const SLOT_HOURS = [18, 19, 20]; // 6‚Äì7, 7‚Äì8, 8‚Äì9
        const SLOT_LABELS = {
            18: '6:00 ‚Äì 7:00 PM',
            19: '7:00 ‚Äì 8:00 PM',
            20: '8:00 ‚Äì 9:00 PM'
        };

        // Manually block specific slots (example format). You can edit this.
        // Use ISO date (YYYY-MM-DD) + hour in 24h format.
        const BLOCKED_SLOTS = [
            // { date: '2025-12-09', hour: 18 },
            // { date: '2025-12-09', hour: 19 },
        ];

        const weekLabelEl = document.getElementById('week-label');
        const slotsGridEl = document.getElementById('slots-grid');
        const prevWeekBtn = document.getElementById('prev-week');
        const nextWeekBtn = document.getElementById('next-week');

        const selectedSlotCard = document.getElementById('selected-slot-card');
        const selectedSlotText = document.getElementById('selected-slot-text');
        const emailRequestBtn = document.getElementById('email-request-btn');
        const lessonLengthButtons = document.querySelectorAll('.lesson-length-btn');

        let weekOffset = 0; // 0 = current week, 1 = next week, -1 = previous, etc.
        let currentSelectedSlot = null;
        let selectedLessonMinutes = null;

        function getMondayOfWeek(date) {
            const d = new Date(date);
            const day = d.getDay(); // Sun=0
            const diff = (day === 0 ? -6 : 1 - day); // Move to Monday
            d.setDate(d.getDate() + diff);
            d.setHours(0, 0, 0, 0);
            return d;
        }

        function formatDateLabel(date) {
            const options = { day: 'numeric', month: 'short' };
            return date.toLocaleDateString('en-GB', options);
        }

        function formatFullDate(date) {
            const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
            return date.toLocaleDateString('en-GB', options);
        }

        function isSameDay(d1, d2) {
            return (
                d1.getFullYear() === d2.getFullYear() &&
                d1.getMonth() === d2.getMonth() &&
                d1.getDate() === d2.getDate()
            );
        }

        function isSlotBlocked(date, hour) {
            const isoDate = date.toISOString().slice(0, 10);
            return BLOCKED_SLOTS.some(
                (s) => s.date === isoDate && s.hour === hour
            );
        }

        function buildWeekDate(baseWeekOffset) {
            const today = new Date();
            const monday = getMondayOfWeek(today);
            monday.setDate(monday.getDate() + baseWeekOffset * 7);
            return monday;
        }

        function renderWeek() {
            slotsGridEl.innerHTML = '';
            currentSelectedSlot = null;
            selectedLessonMinutes = null;
            emailRequestBtn.disabled = true;
            selectedSlotText.textContent = 'Click an available slot on the left to see details here.';
            selectedSlotCard.classList.add('hidden');

            const today = new Date();
            const monday = buildWeekDate(weekOffset);
            const sunday = new Date(monday);
            sunday.setDate(sunday.getDate() + 6);

            weekLabelEl.textContent = `${formatDateLabel(monday)} ‚Äì ${formatDateLabel(sunday)}`;

            TEACHING_DAYS.forEach((dayInfo) => {
                const colDate = new Date(monday);
                const diff = dayInfo.weekday - 1; // Monday=1
                colDate.setDate(colDate.getDate() + diff);

                const dayIsPast =
                    colDate < new Date(today.getFullYear(), today.getMonth(), today.getDate());

                // Column card
                const colDiv = document.createElement('div');
                colDiv.className =
                    'bg-brand-dark-bg rounded-xl border border-brand-accent-dark/60 card-glow p-4 flex flex-col gap-3';

                const header = document.createElement('div');
                header.className = 'flex items-baseline justify-between';
                header.innerHTML = `
                    <div>
                        <p class="text-xs font-semibold tracking-[0.14em] text-brand-text-mid uppercase">${dayInfo.label}</p>
                        <p class="text-sm font-semibold text-brand-text-light">${formatDateLabel(colDate)}</p>
                    </div>
                    <span class="text-[0.7rem] text-brand-text-mid">
                        ${dayIsPast ? 'Earlier this week' : 'Evening slots'}
                    </span>
                `;
                colDiv.appendChild(header);

                const slotsContainer = document.createElement('div');
                slotsContainer.className = 'flex flex-col gap-2 mt-1';

                SLOT_HOURS.forEach((hour) => {
                    const slotDate = new Date(colDate);
                    slotDate.setHours(hour, 0, 0, 0);

                    let isAvailable = true;

                    // Past time?
                    if (slotDate < today) {
                        isAvailable = false;
                    }

                    // Hard rules: only Tue‚ÄìThu evenings (already restricted by TEACHING_DAYS)
                    // Blocked by your own array?
                    if (isSlotBlocked(slotDate, hour)) {
                        isAvailable = false;
                    }

                    const slotDiv = document.createElement('button');
                    slotDiv.type = 'button';
                    slotDiv.className =
                        'slot-pill w-full flex items-center justify-between px-3 py-2 rounded-lg border text-left text-xs sm:text-sm';

                    slotDiv.dataset.dateIso = slotDate.toISOString();
                    slotDiv.dataset.hour = hour;

                    if (isAvailable) {
                        slotDiv.classList.add(
                            'bg-brand-accent-light/10',
                            'border-brand-accent-light/60',
                            'text-brand-text-light'
                        );
                        slotDiv.innerHTML = `
                            <span>${SLOT_LABELS[hour]}</span>
                            <span class="text-[0.7rem] text-brand-accent-light font-semibold">Available</span>
                        `;
                        slotDiv.addEventListener('click', () => handleSlotClick(slotDate, hour));
                    } else {
                        slotDiv.classList.add(
                            'bg-red-900/20',
                            'border-red-500/60',
                            'text-red-200',
                            'disabled'
                        );
                        slotDiv.innerHTML = `
                            <span>${SLOT_LABELS[hour]}</span>
                            <span class="text-[0.7rem] text-red-300 font-semibold">Unavailable</span>
                        `;
                    }

                    slotsContainer.appendChild(slotDiv);
                });

                colDiv.appendChild(slotsContainer);
                slotsGridEl.appendChild(colDiv);
            });
        }

        function handleSlotClick(dateObj, hour) {
            currentSelectedSlot = { date: new Date(dateObj), hour };
            selectedLessonMinutes = null;

            // Reset length button styles
            lessonLengthButtons.forEach(btn => {
                btn.classList.remove(
                    'bg-brand-accent-light/20',
                    'border-brand-accent-light',
                    'text-brand-text-light'
                );
                btn.classList.add('bg-brand-dark-bg');
            });

            const fullDate = formatFullDate(dateObj);
            const label = SLOT_LABELS[hour] || '';

            selectedSlotText.innerHTML = `
                <span class="block text-brand-text-light font-semibold">${fullDate}</span>
                <span class="block text-brand-text-mid">Preferred slot: <strong>${label}</strong></span>
                <span class="block text-[0.7rem] text-brand-text-mid mt-1">
                    Choose a lesson length below, then click the button to email your request.
                </span>
            `;

            selectedSlotCard.classList.remove('hidden');
            emailRequestBtn.disabled = true;
        }

        lessonLengthButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                if (!currentSelectedSlot) return;
                const mins = parseInt(btn.dataset.minutes, 10);
                selectedLessonMinutes = mins;

                // Update button highlighting
                lessonLengthButtons.forEach(b => {
                    b.classList.remove(
                        'bg-brand-accent-light/20',
                        'border-brand-accent-light',
                        'text-brand-text-light'
                    );
                    b.classList.add('bg-brand-dark-bg', 'text-brand-text-mid');
                });

                btn.classList.remove('bg-brand-dark-bg', 'text-brand-text-mid');
                btn.classList.add(
                    'bg-brand-accent-light/20',
                    'border-brand-accent-light',
                    'text-brand-text-light'
                );

                emailRequestBtn.disabled = false;
            });
        });

        emailRequestBtn.addEventListener('click', () => {
            if (!currentSelectedSlot || !selectedLessonMinutes) return;

            const { date, hour } = currentSelectedSlot;
            const fullDate = formatFullDate(date);
            const timeLabel = SLOT_LABELS[hour] || '';
            const length = selectedLessonMinutes;

            const subject = encodeURIComponent(
                `Lesson Enquiry ‚Äì ${fullDate} (${timeLabel}, ${length} mins)`
            );

            const bodyLines = [
                `Hi Elliot,`,
                ``,
                `I'd like to enquire about booking this slot:`,
                `‚Ä¢ Date: ${fullDate}`,
                `‚Ä¢ Time: ${timeLabel}`,
                `‚Ä¢ Lesson length: ${length} minutes`,
                ``,
                `A bit about me / my child:`,
                `[Please add age, experience level, and whether it's piano or singing.]`,
                ``,
                `My postcode (for travel fee):`,
                `[Your postcode here]`,
                ``,
                `Thank you!`,
                ``,
                `[Your name]`
            ];

            const body = encodeURIComponent(bodyLines.join('\n'));

            window.location.href = `mailto:elliotmobilemusic@gmail.com?subject=${subject}&body=${body}`;
        });

        // Week navigation
        prevWeekBtn.addEventListener('click', () => {
            weekOffset -= 1;
            renderWeek();
        });
        nextWeekBtn.addEventListener('click', () => {
            weekOffset += 1;
            renderWeek();
        });

        // Initial render
        renderWeek();
    </script>
</body>
</html>
